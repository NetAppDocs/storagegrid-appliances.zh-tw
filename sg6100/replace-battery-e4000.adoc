---
permalink: sg6100/replace-battery-e4000.html 
sidebar: sidebar 
keywords:  
summary:  
---
= 更換儲存控制器機櫃中的電池（ SG6160 ）
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
如果 SANtricity 系統管理員中的 Recovery Guru 顯示「電池故障」或「電池需要更換」狀態、您必須更換 E4000 控制器中受影響的電池。為了保護您的資料、必須盡快更換電池。

從「還原系統管理程式」檢閱Recovery Guru中的詳細資料、確認電池有問題、並確保不需要先處理其他項目。SANtricity

.開始之前
如果您打算更換故障電池、則必須具備：

* 替換電池。
* 或您已採取其他防靜電預防措施。
* 用於識別連接至控制器容器的每條纜線的標籤。
* 存取 SANtricity 系統管理員：
+
** 從 Grid Manager 中、選取 * 節點 * > * 應用裝置節點 * > * SANtricity 系統管理員 * 。控制器資訊位於 https://docs.netapp.com/us-en/storagegrid/monitor/viewing-santricity-system-manager-tab.html["SANtricity 系統管理員標籤"]。
** 將 Management Station 中的瀏覽器指向控制器的網域名稱或 IP 位址。


* 確認所有使用這些磁碟區的主機上都未使用任何磁碟區、或安裝多重路徑驅動程式。




== 步驟 1 ：準備更換電池

您必須將受影響的控制器離線、以便安全地取出故障電池。您未離線的控制器必須處於線上狀態（處於最佳狀態）。

.步驟
. 從「還原系統管理程式」檢閱Recovery Guru中的詳細資料、確認電池有問題、並確保不需要先處理其他項目。SANtricity
. 從Recovery Guru的「Details（詳細資料）」區域中、判斷要更換的電池。
. 使用 SANtricity System Manager 備份儲存陣列的組態資料庫。
+
如果移除控制器時發生問題、您可以使用儲存的檔案來還原組態。系統會儲存RAID組態資料庫的目前狀態、其中包含控制器上磁碟區群組和磁碟集區的所有資料。

+
** 從系統管理員：
+
... 選擇 * 支援›支援中心›診斷 * 。
... 選擇*收集組態資料*。
... 按一下「* Collect*」。
+
檔案會以*組態Data-<arrayName>-<DateTimer>.7z*的名稱儲存在瀏覽器的「下載」資料夾中。



** 或者、您也可以使用下列CLI命令來備份組態資料庫：
+
`save storageArray dbmDatabase sourceLocation=onboard contentType=all file="filename";`



. 使用SANtricity NetApp System Manager收集儲存陣列的支援資料。
. 如果移除控制器時發生問題、您可以使用儲存的檔案來疑難排解問題。系統會將儲存陣列的庫存、狀態和效能資料儲存在單一檔案中。
+
.. 選擇 * 支援›支援中心›診斷 * 。
.. 選擇*收集支援資料*。
.. 按一下「* Collect*」。
+
檔案會儲存在瀏覽器的 Downloads 資料夾中、其名稱為 support-data.7z 。



. 如果控制器尚未離線、請使用SANtricity 「系統管理程式」將其離線。
+
** 從《系統管理程式》：SANtricity
+
... 選取*硬體*。
... 如果圖形顯示磁碟機、請選取*顯示磁碟櫃背面*以顯示控制器。
... 選取您要離線的控制器。
... 從內容功能表中選取*離線*、然後確認您要執行此作業。
+

NOTE: 如果您使用SANtricity 嘗試離線的控制器來存取「無法使用」功能、SANtricity 就會顯示「無法使用」訊息。選擇*連線至替代網路連線*、即可使用SANtricity 其他控制器自動存取《系統管理程式》。



** 或者、您也可以使用下列CLI命令將控制器離線：
+
* 對於控制器 A* ： `set controller [a] availability=offline`

+
* 對於控制器 B* ： `set controller [b] availability=offline`



. 等待 SANtricity 系統管理員將控制器的狀態更新為離線。
. 從 Recovery Guru 中選擇 *Recheck* ，並確認 * Details （詳細資料） * 區域中的 *OK to remov* （確定要刪除 * ）字段顯示 * Yes （是） * 。這表示可以安全地移除控制器圓筒。




== 步驟 2 ：取下 E4000 控制器箱

您需要從控制器機櫃中取出控制器機箱、以便取出電池。

.開始之前
請確定您擁有下列項目：

* 或您已採取其他防靜電預防措施。
* 用於識別連接至控制器容器的每條纜線的標籤。


.步驟
. 從控制器容器拔下所有纜線。
+

CAUTION: 為避免效能降低、請勿扭轉、摺疊、夾緊或踏上纜線。

. 如果控制器容器上的主機連接埠使用SFP+收發器、請保留安裝狀態。
. 確認控制器背面的快取作用中LED已關閉。
. 壓下凸輪把手上的閂鎖、直到鬆開為止、完全打開凸輪把手、從中間背板釋放控制器圓筒、然後用雙手將控制器圓筒拉出機箱。




== 步驟 3 ：安裝新電池

您必須取出故障電池並更換。

.步驟
. 打開新電池的包裝、放在平坦、無靜電的表面上。
+

NOTE: 為符合IATA安全法規、更換電池的充電狀態（SoC）為30%以下。當您重新接上電源時、請記住、在更換電池充滿電且已完成初始記憶週期之前、寫入快取不會恢復。

. 如果您尚未接地、請正確接地。
. 從機箱中取出控制器圓筒。
. 將控制器圓筒翻轉過來、放在平穩的平面上。
. 按下控制器圓筒兩側的藍色按鈕以打開蓋子、然後向上或向外旋轉控制器圓筒的蓋子。
+
image::../media/drw_E4000_open_controller_module_cover_IEOPS-870.png[打開控制器模組護蓋。]

. 將電池放在控制器箱中。
. 從控制器箱中取出故障電池：
+
.. 按下控制器圓筒側邊的藍色按鈕。
.. 將電池向上滑動、直到其脫離固定支架、然後將電池從控制器圓筒中取出。
.. 將電池從控制器圓筒上拔下。
+
image::../media/drw_E4000_replace_nvbattery_IEOPS-862.png[取出 NVMEM 電池。]

+
|===


 a| 
image::../media/legend_icon_01.png[圖說文字參考 1.]
| 電池釋放彈片 


 a| 
image::../media/legend_icon_02.png[圖說文字參考 2.]
| 電池電源接頭 
|===


. 從包裝中取出替換電池。安裝替換電池：
+
.. 將電池插頭插回控制器圓筒上的插槽。
+
請確定插頭已鎖入主機板上的電池插槽。

.. 將電池與金屬板側壁上的固定支架對齊。
.. 向下滑動電池組、直到電池卡榫卡入、然後卡入側牆的開口。


. 重新安裝控制器圓筒蓋並將其鎖定到位。




== 步驟4：重新安裝控制器容器

更換控制器箱中的元件後、請將其重新安裝到機箱中。

.步驟
. 如果您尚未接地、請正確接地。
. 如果您尚未更換、請更換控制器圓筒上的蓋子。
. 將控制器圓筒翻轉過來、並將末端對齊機箱的開口。
. 將控制器圓筒的末端對準機箱的開口、然後將控制器圓筒輕輕推入系統的一半。
+

NOTE: 在接到指示之前、請勿將控制器圓筒完全插入機箱。

. 視需要重新安裝系統。
. 完成控制器箱的重新安裝：
+
.. 當凸輪把手處於開啟位置時、用力推入控制器圓筒、直到它與中間背板接觸並完全就位、然後將凸輪把手關閉至鎖定位置。
+

NOTE: 將控制器圓筒滑入機箱時、請勿過度施力、以免損壞連接器。

+
控制器一旦安裝在機箱中、就會開始開機。

.. 如果您尚未重新安裝纜線管理裝置、請重新安裝。
.. 使用掛勾和迴圈固定帶將纜線綁定至纜線管理裝置。






== 步驟 5 ：完成電池更換

將控制器置於線上。

.步驟
. 使用SANtricity NetApp System Manager讓控制器上線。
+
** 從《系統管理程式》：SANtricity
+
... 選取*硬體*。
... 如果圖形顯示磁碟機、請選取*顯示磁碟櫃背面*。
... 選取您要放置在線上的控制器。
... 從內容功能表中選取*「線上放置」*、然後確認您要執行此作業。
+
系統會將控制器置於線上。



** 或者、您也可以使用下列CLI命令將控制器重新連線：
+
* 對於控制器 A* ： `set controller [a] availability=online`；

+
* 對於控制器 B* ： `set controller [b] availability=online`；



. 控制器重新上線時、請檢查控制器機櫃的注意 LED 。
+
如果狀態不是「最佳」、或是有任何警示LED亮起、請確認所有纜線均已正確安裝、並檢查電池和控制器機箱是否已正確安裝。如有必要、請移除並重新安裝控制器容器和電池。

+

NOTE: 如果您無法解決問題、請聯絡技術支援部門。
如有需要、請使用SANtricity 《支援系統管理程式》為儲存陣列收集支援資料。

. 確認所有磁碟區都已歸還給偏好的擁有者。
+
.. 選擇 * 儲存› Volumes （磁碟區） * 。從「*所有磁碟區*」頁面、確認磁碟區已散佈至偏好的擁有者。選擇 * 更多›變更擁有者 * 以檢視 Volume 擁有者。
.. 如果磁碟區都是偏好的擁有者所擁有、請繼續執行步驟 4 。
.. 如果未傳回任何磁碟區、則必須手動傳回磁碟區。前往 * 更多›重新分配 Volume * 。
.. 如果在自動發佈或手動發佈之後、只有部分磁碟區會傳回給偏好的擁有者、則必須檢查 Recovery Guru 以瞭解主機連線問題。
.. 如果沒有 Recovery Guru 、或是在執行 Recovery Guru 步驟之後、磁碟區仍未歸還給偏好的擁有者、請聯絡支援部門。


. 使用SANtricity NetApp System Manager收集儲存陣列的支援資料。
+
.. 選擇 * 支援›支援中心›診斷 * 。
.. 選取收集支援資料。
.. 按一下「收集」。
+
檔案會儲存在瀏覽器的 Downloads 資料夾中、其名稱為 support-data.7z 。





.接下來呢？
電池更換完成。您可以恢復正常作業。
